\documentclass[11pt]{article}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode} 

%---enable russian----

\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}

% PROBABILITY SYMBOLS
\newcommand*\PROB\Pr 
\DeclareMathOperator*{\EXPECT}{\mathbb{E}}


% Sets, Rngs, ets 
\newcommand{\N}{{{\mathbb N}}}
\newcommand{\Z}{{{\mathbb Z}}}
\newcommand{\R}{{{\mathbb R}}}
\newcommand{\Zp}{\ints_p} % Integers modulo p
\newcommand{\Zq}{\ints_q} % Integers modulo q
\newcommand{\Zn}{\ints_N} % Integers modulo N

% Landau 
\newcommand{\bigO}{\mathcal{O}}
\newcommand*{\OLandau}{\bigO}
\newcommand*{\WLandau}{\Omega}
\newcommand*{\xOLandau}{\widetilde{\OLandau}}
\newcommand*{\xWLandau}{\widetilde{\WLandau}}
\newcommand*{\TLandau}{\Theta}
\newcommand*{\xTLandau}{\widetilde{\TLandau}}
\newcommand{\smallo}{o} %technically, an omicron
\newcommand{\softO}{\widetilde{\bigO}}
\newcommand{\wLandau}{\omega}
\newcommand{\negl}{\mathrm{negl}} 

% Misc
\newcommand{\eps}{\varepsilon}
\newcommand{\inprod}[1]{\left\langle #1 \right\rangle}

 
\newcommand{\handout}[5]{
  \noindent
  \begin{center}
  \framebox{
    \vbox{
      \hbox to 5.78in { {\bf Научно-исследовательская практика} \hfill #2 }
      \vspace{4mm}
      \hbox to 5.78in { {\Large \hfill #5  \hfill} }
      \vspace{2mm}
      \hbox to 5.78in { {\em #3 \hfill #4} }
    }
  }
  \end{center}
  \vspace*{4mm}
}

\newcommand{\lecture}[4]{\handout{#1}{#2}{#3}{Scribe: #4}{Фи-функция Эйлера #1}}

\newtheorem{theorem}{Теорема}
\newtheorem{lemma}{Лемма}
\newtheorem{definition}{Определение}
\newtheorem{corollary}{Следствие}
\newtheorem{fact}{Факт}

% 1-inch margins
\topmargin 0pt
\advance \topmargin by -\headheight
\advance \topmargin by -\headsep
\textheight 8.9in
\oddsidemargin 0pt
\evensidemargin \oddsidemargin
\marginparwidth 0.5in
\textwidth 6.5in

\parindent 0in
\parskip 1.5ex

\newcounter{example}[section]
\newenvironment{example}[1][]{\refstepcounter{example}\par\medskip
	\noindent \textbf{Пример~\theexample. #1} \rmfamily}{\medskip}

\begin{document}

\lecture{}{Лето 2020}{}{Флягин Артём Иванович}

\section*{7.1 Фи-функция Эйлера}
В данной главе рассматривается часть теории, вытекающей из обобщения Эйлером теоремы Ферма. В двух словах, Эйлер расширил теорему Ферма для простых чисел до произвольных.При этом он ввел важную теорию числового отбора, которая описывается следующим образом: 
\begin{definition}
\label{def:7-1}
		Для любого $n>1$ существует $\phi(n)$ которая указывает количество чисел не превышающих $n$, взаимнопростых с $n$. 
\end{definition}
В качестве иллюстрации определения, мы найдем $\phi(30) = 8$. Для всех чисел, не превышающих 30 существует восемь чисел взаимнопростых с числом 30, а точнее:
\[1,7,11,13,17,19,23,29. \]
Аналогично для первых нескольких положительных чисел читатель может проверить следующее: 
\[\phi (1)=1,\phi (2)=1,\phi (3)=2,\phi (4)=2,\phi (5)=4,\phi (5)=2,\phi (7)=6  , \ldots\]
Обозначим $\phi (1)=1$ в то время как  $\text{НОД}(1,1)=1$. Если $n>1$ то  $\text{НОД}(n,n)=n\not= 1$, тогда $\phi (n) $ может характеризовать количество целых чисел меньших n и взаимно простыми с $n$. Функция $\phi$ обычно называется функцией Эйлера, в честь автора. Однако обозначение $\phi (n)$ появилось благодаря Гауссу. 

Если $n$ является простым числом, то каждое простое число меньшее $n$ будет взаимно простым с $n$. Из этого утверждения следует что для любого простого $n$ $\phi (n)=n-1$. С другой стороны, если $n>1$ составное, то существет некоторый делитель $d$ такой, что $1<d<n$. Из этого следует что как минимум два целых числа из $1,2,3,\ldots, n$ не взаимнопростые с $n$ а именно $d$ и само $n$. В результате $\phi (n) \leq n-2$. Это утверждение доказано только для $n>1$. 

\begin{center}
	$\phi (n)=n-1$ тогда и только тогда, когда $n$ - простое число
\end{center}
Первая вещь, которую нужно сделать, это определить формулу, которая позволит нам вычислять значение $\phi (n)$ напрямую из разложения $n$ на простые множители. Большой шаг напути к этому делает следующая теорема: 
\begin{theorem}
\label{th:7-1}
	
	Если $ p $ простое число и $ k>0 $, тогда 
	\[\phi (p^{k})=	p^{k}-p^{k-1}=p^{k}(1-\dfrac{1}{p}).\]
\end{theorem} 
\begin{proof}
	Очевидно,  $\text{НОД}(n,p^k)=1$ тогда и только тогда, когда $p\nmid n$. Тогда $p^{k-1}$ целые между $1$ и $p^{k}$ которые являются делителем $p$, а именно  
	\[p,2p,3p, \ldots, (p^{k-1})p.\] Таким образом множество $\{1,2,\ldots,p^k\}$ содержит исключительно $p^{k}-p^{k-1}$ целых которые взаимно просты с $p^k$ и тогда, согласно определению ~\ref{def:7-1},r $\phi (p^k)=p^{k}-p^{k-1}.$	
	
	Например мы имеем 
	\[
	\phi (9)=\phi (3^2)=3^{2}-3=6;
	\]
	Шесть целых которые меньше $9$ и взаимнопросты с $9$ это $1, 2, 4, 5, 7, 8$.
	Чтобы привести вторую иллюстрацию, приведем $8$ целых чисел которые меньше чем $16$ и взаимно просты с этим числом - это $1,3,5,7,9,11,13,15$. Теорема $1$ дает тот же результат:
	\[
	\phi (16)= \phi (2^4)=2^{4}-2{3}=16-8=8.
	\]
	Мы знаем как вычислить фи-функцию для простых чисел и теперь наша цель получить формулу для $\phi (n)$ основываясь на разложении числа $n$ на простые множители. Отсутствующее звено в цепи очевидно: покажем что $\phi $ - мультипликативная функция. И мы сделаем это с помощью простой леммы.
	
\begin{lemma}
Для целых $a, b, c$  $\text{НОД}(a,bc) = 1$ тогда и только тогда, когда  $\text{НОД}(a,b)=1$ и  $\text{НОД}(a,c)=1$.
\end{lemma}
\begin{proof}
	Предположим что  $\text{НОД}(a,bc)=1$ и получим $d=$ $\text{НОД}(a,b)$. Тогда $d\mid a$ и $d\mid b$, откуда $d \mid a$ и $d\mid bc$. Это подразумевает что НОД$(a,bc) \geq d$, что равносильно $d=1$. Аналогичные рассуждения приведут к выражению  $\text{НОД}(a,c)=1$. 
\end{proof}
	Для другого направления возьмем  $\text{НОД}(a,b)=1=$ $\text{НОД}(a,c)$ и подразумевает что  $\text{НОД}(a,bc)=d_{1}>1.$ Тогда $d_1$ должен быть простым делителем $p$. Из $d_{1} \mid bc$, из этого следует что $p \mid bc$; а в последствии $p \mid b$ или $p \mid c$. Если $p \mid b$, тогда (в силу того что $p \mid a$)  $\text{НОД}(a,b) \geq p $ что является противоречием. Точно так же предположение $p \mid c$ следует из такого же ложного заключения что  $\text{НОД}(a,c) \geq p)$. Таким образом $d_1 = 1$ и лемма доказана.
\end{proof}
\begin{theorem}
	Функция $\phi$ это мультипликативная функция
\end{theorem}
\begin{proof}
	Требуется доказать что $\phi (mn)=\phi (m) \phi(n)$, когда $m$ и $n$ имеют общий делитель. Так как $\phi(1)=1$, результат очевиден, если $m$ или $n$ равен $1$. В таком случае мы можем предположить что $m>1$ и $n>1$. Организуем целые числа от $1$ до $mn$ в $n$ столбцах целых чиел следующим образом:
	\[
	\begin{matrix}
	1 & 2 & \ldots & r & \ldots & m \\
	m+1 & m+2 &  & m+r& & 2m\\
	2m+1 & 2m+2 &  & 2m+r& & 3m\\
	\vdots&\vdots& &\vdots&\vdots\\
	(n-1)m+1 & (n-1)m+2 &  & (n-1)m+r& & nm
	\end{matrix}
	\]
	Мы знакм что $\phi(mn)$ равно номеру взаимнопростой с $mn$ записи в вышеприведенном массиве. Достоинство этой леммы это одинаковое количество целых чисел которые взаимнопросты с $m$ и $n$.
	
	Перед осуществление деталей стоит прокомментировать тактику, которую следует принять: Так как  $\text{НОД}(gm+r,m)=$ $\text{НОД}(r,m)$, числа $r$-той колнки взаимно просты с $m$ тогда и только тогда, когда $r$ взаимнопросто с $m$. Следовательно, только $\phi(m)$ столбцы содержат взаимнопростые с $m$, и каждый элемент этого столбца будет взаимнопростым с $m$. Проблема заключается в том что бы показать что в каждом из $\phi(m)$ столбцов содержится исключительно $\phi(n)$ целых чисел, которые взаимнопростые с $n$; Тогда будет всего $\phi(m) \phi(n)$ чисел в таблице, которые взаимнопросты и с $m$  и с $n$.
	
	Теперь в $r$-той колонке (где предполагаемо  $\text{НОД}(r,m)=1$) имеем
	\[
	r, m+r,2m+r,\ldots,(n-1)m+r.
	\]
	Это множество $n$ целых чисел. В этом множестве никакие два элемента не совпадают с модулем $n$. Действительно,
	\[km+r \equiv jm+r
	\]
	$0\leq k<j<n$,из этого может следовать что $km\equiv jm  \pmod{n}$. Так как  $\text{НОД}(m,n)=1$ мы можем сократить $m$ с двух сторон этого сравнения для получения противоречия $k \equiv j \pmod{n}$. Таким образом числа в $r$-том столбике сравнимы с числом $n$ по модулю $0,1,2,\ldots,n-1,$ по порядку. Но если $s \equiv t \pmod {n}$, тогда  $\text{НОД}(s,n)=1$ тогда и только тогда, когда  $\text{НОД}(t,n)=1$. Подразумевается, что столбец $r$ содержит в себе множество целых чисел которые взаимнопросты с $n$, как и все множество ${1,2,\ldots,n-1}$, а именно $\phi(n)$ целых. Следовательно, общее количество целых чисел взаимнопростых с $n$ и $m$, содержащихся в массиве, численно равно $\phi(n) \phi(m)$. Теорема доказана.
\end{proof}
\begin{center}
Теперь мы можем доказать следующее
\end{center}
\begin{theorem}
	Если целое $n>1$ имеет разложение на простые множители $n=p_{1}^{k_1},p_{2}^{k_2},\ldots, p_{r}^{k_r}$, тогда
	\[\phi(n) =(p_{1}^{k_1}-p_{1}^{k_{1}-1})(p_{2}^{k_{2}}-p_{2}^{k_{2}-1})\cdots (p_{r}^{k_{r}}-p_{r}^{k_{r}-1})=n(1-1/p_1)(1-1/p_2)\ldots(1-1/p_r).\]
\end{theorem}
\begin{proof}
	Воспользуемся индукцией по $r$ числу различных простых множителей $n$. Согласно теореме ~\ref{th:7-1}, результат верен для $r=1$. Предположим что это выполняется для $r=i$. Так как
\begin{center}
	НОД$(p^{k_1}_{1}p^{k_2}_{2}\cdots p^{k_i}_{i}p^{k_{i+1}}_{i+1})=1$
\end{center}
Из определения мультипликативной функции следует
\[\phi((p_{k_1}^{1}\cdots p^{k_i}_{i+1})p_{i+1}^{k_{i+1}})=\phi(p^{k_1}_{1}\cdots p_{i}^{k_i}) \phi(p_{i+1}^{k_{i+1}})=\phi(p_{1^{k_1}}\cdots p_{i}^{k_{i}})(p_{i+1}^{k_{i+1}}-p_{i+1}^{k_{i+1}-1}).\]
Ссылаясь на предположение индукции, первый множитель справа становится
\[\phi(p_{1}^{k_1}p_{2}^{k_2}\cdots p_{i}^{k_i})=(p_{1}^{k_1}-p_{1}^{k_1-1})(p_{2}^{k_2}-p_{2}^{k_2-1})\cdots
(p_{i}^{k_i}-p_{i}^{k_i-1})\]
Это являетя доказательством шага индукции, а так же и теоремы.
\end{proof}
\begin{example}
	Давайте вычислим для примера значение $\phi(360)$. Простое разложение числа $360$ это $2^3\cdot3^2\cdot5$, и теорема $3$ гласит что 
	\[\phi(360)=360(1-1/2)(1-1/3)(1-1/5)=360\cdot1/2\cdot2/3\cdot4/5=96.
	\]
\end{example}																					
\end{document}